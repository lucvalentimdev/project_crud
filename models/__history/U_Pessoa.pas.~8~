unit U_Pessoa;
interface

uses
   U_Endereco, DM_Principal;

type

  TPessoa = class
  private
    FIdPessoa : Integer;
    FTipoPessoa: Integer;
    FNome: string;
    FDataNascimento: TDate;
    FCPF: string;
    FRG: string;
    FEmail: string;
    FTelefone: string;
    FEndereco: TEndereco;

  public

    property IdPessoa : Integer     read FIdPessoa       write FIdPessoa;
    property TipoPessoa: Integer    read FTipoPessoa     write FTipoPessoa;
    property Nome: string           read FNome           write FNome;
    property DataNascimento: TDate  read FDataNascimento write FDataNascimento;
    property CPF: string            read FCPF            write FCPF;
    property RG: string             read FRG             write FRG;
    property Email: string          read FEmail          write FEmail;
    property Telefone: string       read FTelefone       write FTelefone;
    property Endereco: TEndereco    read FEndereco       write FEndereco;

    constructor Create(ATipoPessoa: Integer; ANome: string; ADataNascimento: TDate; ACPF: string; ARG: string;
    AEmail: string ; ATelefone: string; AEndereco: TEndereco); overload;

    procedure Salvar;

end;


implementation

constructor TPessoa.Create(ATipoPessoa: Integer; ANome: string; ADataNascimento: TDate; ACPF, ARG, AEmail, ATelefone: string; AEndereco: TEndereco);
begin
   FTipoPessoa     := ATipoPessoa;
   FNome           := ANome;
   FDataNascimento := ADataNascimento;
   FCPF            := ACPF;
   FRG             := ARG;
   FEmail          := AEmail;
   FTelefone       := ATelefone;
   FEndereco       := AEndereco;
end;

procedure TPessoa.Salvar;
var
 Script : string;
begin
  Script := 'INSERT INTO Pessoa (tipo_pessoa_id, nome, data_nascimento, cpf, rg, email, telefone, cep, logradouro, bairro, cidade, estado, complemento, numero) ' +
         'VALUES (:tipo_pessoa_id, :nome, :data_nascimento, :cpf, :rg, :email, :telefone, :cep, :logradouro, :bairro, :cidade, :estado, :complemento, :numero)';

   try
      Data_Module.FQry_Op.SQL.Text                                := Script;
      Data_Module.FQry_Op.ParamByName('nome').AsString            := Self.Nome;
      Data_Module.FQry_Op.ParamByName('data_nascimento').AsDate   := Self.DataNascimento;
      Data_Module.FQry_Op.ParamByName('cpf').AsString             := Self.CPF;
      Data_Module.FQry_Op.ParamByName('rg').AsString              := Self.RG;
      Data_Module.FQry_Op.ParamByName('email').AsString           := Self.Email;
      Data_Module.FQry_Op.ParamByName('telefone').AsString        := Self.Telefone;
      Data_Module.FQry_Op.ParamByName('cep').AsString             := Self.Endereco.CEP;
      Data_Module.FQry_Op.ParamByName('logradouro').AsString      := Self.Endereco.Logradouro;
      Data_Module.FQry_Op.ParamByName('bairro').AsString          := Self.Endereco.Bairro;
      Data_Module.FQry_Op.ParamByName('cidade').AsString          := Self.Endereco.Cidade;
      Data_Module.FQry_Op.ParamByName('estado').AsString          := Self.Endereco.Estado;
      Data_Module.FQry_Op.ParamByName('complemento').AsString     := Self.Endereco.Complemento;
      Data_Module.FQry_Op.ParamByName('numero').AsString          := Self.Endereco.Numero;
      Data_Module.FQry_Op.ExecSQL;
   except
      raise;
   end;
end;



end.
